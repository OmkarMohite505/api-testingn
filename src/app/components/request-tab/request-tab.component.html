<div class="lft-side-ver-panel-menu">
  <i class="pi pi-plus" (click)="createCollection()"></i>
  <p-panelMenu [model]="collectionItems" />
</div>

<div class="main-content">
<div class="horizontal-main-tabs">
  <p-tabView
    [(activeIndex)]="activeTabIndex"
    (onChange)="onTabChange($event)"
    (onClose)="onTabClose($event)"
  >
    <p-tabView [(activeIndex)]="activeTabIndex" [scrollable]="true">
      <p-tabPanel
        *ngFor="let tab of requestTabs"
        [header]="tab.name ?? ''"
        [closable]="true"
      >
      </p-tabPanel>
    </p-tabView>
  </p-tabView>
</div>

<div class="horizontal-second-row">
  <p-dropdown
    [options]="requestTypeList"
    [(ngModel)]="activeTab.request.reqType"
    appendTo="Body"
  />
  <input
    type="text"
    pInputText
    [(ngModel)]="activeTab.request.url"
    style="width: 50%"
  />
  <p-splitButton
    label="Send"
    (onClick)="sendHttpRequest('info')"
    [model]="items"
  />
  <p-splitButton
    label="Save"
    (onClick)="saveReqTabInCollection()"
    [model]="items"
  />
</div>
<div class="hor-sub-tab-sec-row">
  <p-tabView (onChange)="onSubTabChange($event)">
    @for (section of tabSections; track section.label) {
    <p-tabPanel [header]="section.label">
      <ng-container [ngSwitch]="activeSubTab">
        <ng-container *ngSwitchCase="'Params'"> </ng-container>
        <ng-container *ngSwitchCase="'Authorization'"> </ng-container>
        <ng-container *ngSwitchCase="'Headers'"> </ng-container>
        <ng-container *ngSwitchCase="'Body'">
          <div style="width: 600px; height: 300px">
            <app-editor
              [editorOptions]="editorOptions"
              [code]="activeTab.request.body ?? ''"
              (codeChanged)="onBodyChange($event)"
            ></app-editor>
          </div>
        </ng-container>
      </ng-container>
    </p-tabPanel>
    }
  </p-tabView>
</div>

<div class="response-area">
  <div style="width: 1000px; height: 600px">
    <app-editor
      [editorOptions]="editorOptions"
      [code]="activeTab.response.body"
      [isFormatEditor]="true"
    ></app-editor>
  </div>
</div>
</div>






<p-dialog header="Create Collection" [modal]="true" [(visible)]="showCreateCollecDialog" [style]="{ width: '25rem' }">
    <span class="p-text-secondary block mb-5">Name</span>
    <div class="flex align-items-center gap-3 mb-3">
        <input [(ngModel)]="newCollectionName" pInputText id="username" class="flex-auto" autocomplete="off" />
    </div>
    <div class="flex justify-content-end gap-2">
        <p-button label="Cancel" severity="secondary" (onClick)="showCreateCollecDialog = false" />
        <p-button label="Save" (onClick)="showCreateCollecDialog = false; createCollection('save')"/>
    </div>
</p-dialog>


<p-dialog header="Save Request" [modal]="true" [(visible)]="showSaveReqTabDialog" [style]="{ width: '25rem', heigth: '50rem' }">
    <span class="p-text-secondary block mb-5">Name</span>
     <p-dropdown
    [options]="collectionsList"
    [(ngModel)]="selectedCollectionId"
    optionLabel="name"
    optionValue="code"
    appendTo="Body"
  />
    <div class="flex align-items-center gap-3 mb-3">
        <input [(ngModel)]="newReqTabName" pInputText id="newTabReqName" class="flex-auto" [value]="newReqTabName" autocomplete="off" />
    </div>
    <div class="flex justify-content-end gap-2">
        <p-button label="Cancel" severity="secondary" (onClick)="showSaveReqTabDialog = false" />
        <p-button label="Save" (onClick)="showSaveReqTabDialog = false; saveReqTabInCollection('save')"/>
    </div>
</p-dialog>
